<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>merge_pagwas — merge_pagwas • scPagwas</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="merge_pagwas — merge_pagwas"><meta property="og:description" content="Merging several pagwas result to one result.When your single
cell data is too large to run, you can split your data into several
split, then use this function to merge them. Split the data randomly or
in order of cellytpes."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-12345678-0"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-12345678-0');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scPagwas</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.10.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Bmmc_monocytecount_singlecell_celltype_vignette.html">Bmmc_monocytecount_singlecell_celltype_vignette</a>
    </li>
    <li>
      <a href="../articles/Data_input_preproccess_for_scPagwas.html">Data_input_preproccess_for_scPagwas</a>
    </li>
    <li>
      <a href="../articles/Multi_TraitFiles_for_one_SingleData_running.html">Multi_TraitFiles_for_one_SingleData_running</a>
    </li>
    <li>
      <a href="../articles/Running_scPagwas_steps_by_SubFunctions.html">Running_scPagwas_steps_by_SubFunctions</a>
    </li>
    <li>
      <a href="../articles/Split_big_scRNAseqData_and_integrate_result.html">Split_big_scRNAseqData_and_integrate_result</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>merge_pagwas</h1>
    
    <div class="hidden name"><code>merge_pagwas.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Merging several pagwas result to one result.When your single
cell data is too large to run, you can split your data into several
split, then use this function to merge them. Split the data randomly or
in order of cellytpes.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">merge_pagwas</span><span class="op">(</span>Pagwas_list <span class="op">=</span> <span class="cn">NULL</span>, n_topgenes <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>Pagwas_list</dt>
<dd><p>list format, element including seruat format result.</p></dd>
<dt>n_topgenes</dt>
<dd><p>(integr)Number of top associated gene selected to calculate the scPagwas score;</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>1.The rownames genes and gwas data must uniform.
2.The merge_pagwas function only can use to merge the seruat format result.
That is "singlecell = T;celltype =F" can use to all the split data,
"singlecell = T;celltype = T" can be used only when the data is splited by celltypes.
but "singlecell = F;celltype =T" can not be used.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Chunyu Deng</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">scPagwas</span><span class="op">)</span></span>
<span class="r-in"><span class="va">Pagwas</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat" class="external-link">Seurat</a></span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching SeuratObject</span>
<span class="r-in"><span class="va">scRNAexample</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"scRNAexample.rds"</span>, package <span class="op">=</span> <span class="st">"scPagwas"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">Example_splice1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">scRNAexample</span>,idents<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Celltype1"</span>,<span class="st">"Celltype2"</span>,<span class="st">"Celltype3"</span>,<span class="st">"Celltype4"</span>, <span class="st">"Celltype5"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">Example_splice2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">scRNAexample</span>,idents<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"Celltype6"</span>,<span class="st">"Celltype7"</span>,<span class="st">"Celltype8"</span>,<span class="st">"Celltype9"</span>,<span class="st">"Celltype10"</span> <span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">gwas_data</span> <span class="op">&lt;-</span> <span class="fu">bigreadr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bigreadr/man/fread2.html" class="external-link">fread2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"GWAS_summ_example.txt"</span>, package <span class="op">=</span> <span class="st">"scPagwas"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">Pagwas</span> <span class="op">&lt;-</span> <span class="fu"><a href="GWAS_summary_input.html">GWAS_summary_input</a></span><span class="op">(</span></span>
<span class="r-in">  Pagwas <span class="op">=</span> <span class="va">Pagwas</span>,</span>
<span class="r-in">  gwas_data <span class="op">=</span> <span class="va">gwas_data</span>,</span>
<span class="r-in">  maf_filter <span class="op">=</span> <span class="fl">0.1</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Input gwas summary data frame!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> No "chr" from chrom!, now pasting it!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filtering out SNPs with MAF criterion</span>
<span class="r-in"><span class="va">Pagwas</span><span class="op">$</span><span class="va">snp_gene_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="Snp2Gene.html">Snp2Gene</a></span><span class="op">(</span>snp <span class="op">=</span> <span class="va">Pagwas</span><span class="op">$</span><span class="va">gwas_data</span>, refGene <span class="op">=</span> <span class="va">block_annotation</span>, marg <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Computing distances between SNPs and genes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5332 SNPs not inside gene domain</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ** Computing distance to domain starts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ** Computing distance to domain ends</span>
<span class="r-in"><span class="co">#Run the first split data</span></span>
<span class="r-in"><span class="va">Pagwas1</span><span class="op">&lt;-</span><span class="fu"><a href="scPagwas_main.html">scPagwas_main</a></span><span class="op">(</span>Pagwas <span class="op">=</span><span class="va">Pagwas</span>,</span>
<span class="r-in">                      gwas_data <span class="op">=</span><span class="cn">NULL</span>,</span>
<span class="r-in">                       Single_data <span class="op">=</span><span class="va">Example_splice1</span>,</span>
<span class="r-in">                       output.prefix<span class="op">=</span><span class="st">"splice1"</span>,</span>
<span class="r-in">                       output.dirs<span class="op">=</span><span class="st">"splice_scPagwas"</span>,</span>
<span class="r-in">                       Pathway_list<span class="op">=</span><span class="va">Genes_by_pathway_kegg</span>,</span>
<span class="r-in">                       ncores<span class="op">=</span><span class="fl">5</span>,</span>
<span class="r-in">                       assay<span class="op">=</span><span class="st">"RNA"</span>,</span>
<span class="r-in">                       block_annotation <span class="op">=</span> <span class="va">block_annotation</span>,</span>
<span class="r-in">                       chrom_ld <span class="op">=</span> <span class="va">chrom_ld</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ##------ Tue Jul 19 14:15:20 2022 ------## ******* 1st: Single_data_input function start! ********</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Input single cell data!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 5 cell types are remain, after filter!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> done!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ##------ Tue Jul 19 14:15:24 2022 ------## ******* 2nd: Pathway_pcascore_run function start!! ********</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> * Start to get Pathway SVD socre!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |==============                                                        |  20%[1] "Celltype1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |============================                                          |  40%[1] "Celltype2"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |==========================================                            |  60%[1] "Celltype3"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |========================================================              |  80%[1] "Celltype4"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |======================================================================| 100%[1] "Celltype5"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using score as value column: use value.var to override.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> done!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ##------ Tue Jul 19 14:15:31 2022 ------## ******* 3rd: GWAS_summary_input function start! ********</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ##------ Tue Jul 19 14:15:31 2022 ------## ******* 5th: Pathway_annotation_input function start! ********</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> obtain the pathway block information</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> done!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ##------ Tue Jul 19 14:15:33 2022 ------## ******* 6th: Link_pathway_blocks_gwas function start! ********</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> * Start to link gwas and pathway block annotations for 278 pathways!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in setkeyv(x, cols, verbose = verbose, physical = physical):</span> x is not a data.table</span>
<span class="r-in"><span class="va">Pagwas2</span><span class="op">&lt;-</span><span class="fu"><a href="scPagwas_main.html">scPagwas_main</a></span><span class="op">(</span>Pagwas <span class="op">=</span><span class="va">Pagwas</span>,</span>
<span class="r-in">                      gwas_data <span class="op">=</span><span class="cn">NULL</span>,</span>
<span class="r-in">                      Single_data <span class="op">=</span><span class="va">Example_splice2</span>,</span>
<span class="r-in">                      output.prefix<span class="op">=</span><span class="st">"splice2 "</span>,</span>
<span class="r-in">                      output.dirs<span class="op">=</span><span class="st">"splice_scPagwas"</span>,</span>
<span class="r-in">                      Pathway_list<span class="op">=</span><span class="va">Genes_by_pathway_kegg</span>,</span>
<span class="r-in">                      ncores<span class="op">=</span><span class="fl">5</span>,</span>
<span class="r-in">                      assay<span class="op">=</span><span class="st">"RNA"</span>,</span>
<span class="r-in">                      block_annotation <span class="op">=</span> <span class="va">block_annotation</span>,</span>
<span class="r-in">                      chrom_ld <span class="op">=</span> <span class="va">chrom_ld</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ##------ Tue Jul 19 14:15:33 2022 ------## ******* 1st: Single_data_input function start! ********</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Input single cell data!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 5 cell types are remain, after filter!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> done!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ##------ Tue Jul 19 14:15:34 2022 ------## ******* 2nd: Pathway_pcascore_run function start!! ********</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> * Start to get Pathway SVD socre!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |==============                                                        |  20%[1] "Celltype6"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |============================                                          |  40%[1] "Celltype7"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |==========================================                            |  60%[1] "Celltype8"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |========================================================              |  80%[1] "Celltype9"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |======================================================================| 100%[1] "Celltype10"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using score as value column: use value.var to override.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> done!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ##------ Tue Jul 19 14:15:39 2022 ------## ******* 3rd: GWAS_summary_input function start! ********</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ##------ Tue Jul 19 14:15:39 2022 ------## ******* 5th: Pathway_annotation_input function start! ********</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> obtain the pathway block information</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> done!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ##------ Tue Jul 19 14:15:40 2022 ------## ******* 6th: Link_pathway_blocks_gwas function start! ********</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> * Start to link gwas and pathway block annotations for 273 pathways!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in setkeyv(x, cols, verbose = verbose, physical = physical):</span> x is not a data.table</span>
<span class="r-in"><span class="va">Pagwas_integrate</span> <span class="op">&lt;-</span> <span class="fu">merge_pagwas</span><span class="op">(</span>Pagwas_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Pagwas1</span>,<span class="va">Pagwas2</span><span class="op">)</span>,n_topgenes <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in merge_pagwas(Pagwas_list = list(Pagwas1, Pagwas2), n_topgenes = 1000):</span> object 'Pagwas1' not found</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Chunyu Deng.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

