<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Merging several pagwas result to one result.When your single
cell data is too large to run, you can split your data into several
split, then use this function to merge them. Split the data randomly or
in order of cellytpes."><title>merge_pagwas — merge_pagwas • scPagwas</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="merge_pagwas — merge_pagwas"><meta property="og:description" content="Merging several pagwas result to one result.When your single
cell data is too large to run, you can split your data into several
split, then use this function to merge them. Split the data randomly or
in order of cellytpes."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">scPagwas</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Bmmc_monocytecount_singlecell_celltype_vignette.html">Bmmc_monocytecount_singlecell_celltype_vignette</a>
    <a class="dropdown-item" href="../articles/Data_input_preproccess_for_scPagwas.html">Data_input_preproccess_for_scPagwas</a>
    <a class="dropdown-item" href="../articles/Multi_TraitFiles_for_one_SingleData_running.html">Multi_TraitFiles_for_one_SingleData_running</a>
    <a class="dropdown-item" href="../articles/Prune_GwasSummaryFIles_plink.html">Prune_GwasSummaryFIles_plink</a>
    <a class="dropdown-item" href="../articles/Running_scPagwas_steps_by_SubFunctions.html">Running_scPagwas_steps_by_SubFunctions</a>
    <a class="dropdown-item" href="../articles/Split_big_scRNAseqData_and_integrate_result.html">Split_big_scRNAseqData_and_integrate_result</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>merge_pagwas</h1>
      
      <div class="d-none name"><code>merge_pagwas.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Merging several pagwas result to one result.When your single
cell data is too large to run, you can split your data into several
split, then use this function to merge them. Split the data randomly or
in order of cellytpes.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">merge_pagwas</span><span class="op">(</span></span>
<span>  Single_data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_topgenes <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  output.dirs <span class="op">=</span> <span class="st">"splice_scPagwas"</span>,</span>
<span>  assay <span class="op">=</span> <span class="st">"RNA"</span>,</span>
<span>  random <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1234</span>,</span>
<span>  random_times <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  proportion <span class="op">=</span> <span class="fl">0.3</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>Single_data</dt>
<dd><p>The Whole single cell data set. rds files in seurat format.
The filesnames or seurat format data.</p></dd>


<dt>n_topgenes</dt>
<dd><p>(integr)Number of top associated gene selected to
calculate the scPagwas score;</p></dd>


<dt>output.dirs</dt>
<dd><p>The files names for the result of scPagwas_main function.</p></dd>


<dt>assay</dt>
<dd><p>The assay used for single cell data.</p></dd>


<dt>random</dt>
<dd><p>Whether split the Single_data in random.
Using id when the Single_data is too big to run.</p></dd>


<dt>seed</dt>
<dd><p>The seed for random.</p></dd>


<dt>random_times</dt>
<dd><p>The times for random, default is 10.</p></dd>


<dt>proportion</dt>
<dd><p>The proportion for spliting the Single_data; the bigger for
Single_data the less proportion for spliting, and the more times for random_times.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>seurat format result for scPagwas.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>1.The rownames genes and gwas data must uniform.
2.The merge_pagwas function only can use to merge the seurat format
result.
That is "singlecell = T;celltype =F" can use to all the split data,
"singlecell = T;celltype = T" can be used only when the data is splited
by celltypes.
but "singlecell = F;celltype =T" can not be used.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Chunyu Deng</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat" class="external-link">Seurat</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching SeuratObject</span>
<span class="r-in"><span><span class="va">scRNAexample</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"scRNAexample.rds"</span>, package <span class="op">=</span> <span class="st">"scPagwas"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#set the output.dirs for any directory.</span></span></span>
<span class="r-in"><span><span class="va">set.dirs</span><span class="op">=</span><span class="st">"D:/OneDrive/GWAS_Multiomics/Pagwas/test/"</span></span></span>
<span class="r-in"><span><span class="co">#set the number of split time, it depend on the size of your single cell data.</span></span></span>
<span class="r-in"><span><span class="co">#There have two form of spliting the data:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#########</span></span></span>
<span class="r-in"><span><span class="co">##1.By Random</span></span></span>
<span class="r-in"><span><span class="co">#Create the random index number.</span></span></span>
<span class="r-in"><span><span class="va">n_split</span><span class="op">=</span><span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">Split_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_split</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">scRNAexample</span><span class="op">)</span><span class="op">/</span><span class="va">n_split</span><span class="op">)</span>, length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">scRNAexample</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_split</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">Example_splice</span> <span class="op">&lt;-</span> <span class="va">scRNAexample</span><span class="op">[</span>,<span class="va">Split_index</span><span class="op">==</span><span class="va">i</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">Example_splice</span>,file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">set.dirs</span>,<span class="st">"Example_splice"</span>,<span class="va">i</span>,<span class="st">".rds"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#########</span></span></span>
<span class="r-in"><span><span class="co">###1.By celltypes</span></span></span>
<span class="r-in"><span><span class="co">#Create the random index number.</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="fu"><a href="https://mojaveazure.github.io/seurat-object/reference/Idents.html" class="external-link">Idents</a></span><span class="op">(</span><span class="va">scRNAexample</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">Example_splice</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">scRNAexample</span>,idents <span class="op">=</span> <span class="va">i</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">Example_splice</span>,file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">set.dirs</span>,<span class="st">"Example_splice"</span>,<span class="va">i</span>,<span class="st">".rds"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">Pagwas</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gwas_data</span> <span class="op">&lt;-</span> <span class="fu">bigreadr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bigreadr/man/fread2.html" class="external-link">fread2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"GWAS_summ_example.txt"</span>, package <span class="op">=</span> <span class="st">"scPagwas"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Pagwas</span> <span class="op">&lt;-</span> <span class="fu"><a href="GWAS_summary_input.html">GWAS_summary_input</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  Pagwas <span class="op">=</span> <span class="va">Pagwas</span>,</span></span>
<span class="r-in"><span>  gwas_data <span class="op">=</span> <span class="va">gwas_data</span>,</span></span>
<span class="r-in"><span>  maf_filter <span class="op">=</span> <span class="fl">0.1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Input gwas summary data frame!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> No "chr" from chrom!, now pasting it!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filtering out SNPs with MAF criterion</span>
<span class="r-in"><span><span class="va">Pagwas</span><span class="op">$</span><span class="va">snp_gene_df</span> <span class="op">&lt;-</span> <span class="fu">Snp2Gene</span><span class="op">(</span>snp <span class="op">=</span> <span class="va">Pagwas</span><span class="op">$</span><span class="va">gwas_data</span>, refGene <span class="op">=</span> <span class="va">block_annotation</span>, marg <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in Snp2Gene(snp = Pagwas$gwas_data, refGene = block_annotation,     marg = 10000):</span> could not find function "Snp2Gene"</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">Pagwas</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "gwas_data"</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="va">set.dirs</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_split</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="scPagwas_main.html">scPagwas_main</a></span><span class="op">(</span>Pagwas <span class="op">=</span><span class="va">Pagwas</span>,</span></span>
<span class="r-in"><span>                gwas_data <span class="op">=</span><span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>                Single_data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Example_splice"</span>,<span class="va">i</span>,<span class="st">".rds"</span><span class="op">)</span>, <span class="co">#the</span></span></span>
<span class="r-in"><span>                output.prefix<span class="op">=</span><span class="va">i</span>, <span class="co">#the prefix can be the circulation coefficient i.</span></span></span>
<span class="r-in"><span>                output.dirs<span class="op">=</span><span class="st">"splice_scPagwas"</span>, <span class="co">#the output.dirs shoukd be the same for each circulation</span></span></span>
<span class="r-in"><span>                Pathway_list<span class="op">=</span><span class="va">Genes_by_pathway_kegg</span>,</span></span>
<span class="r-in"><span>                run_split<span class="op">=</span><span class="cn">TRUE</span>, <span class="co">#This parameter is set to run single result for each split result.</span></span></span>
<span class="r-in"><span>                min_clustercells<span class="op">=</span><span class="fl">1</span>, <span class="co">#the minimum cluster cell number should be 1.</span></span></span>
<span class="r-in"><span>                assay<span class="op">=</span><span class="st">"RNA"</span>,</span></span>
<span class="r-in"><span>                block_annotation <span class="op">=</span> <span class="va">block_annotation</span>,</span></span>
<span class="r-in"><span>                chrom_ld <span class="op">=</span> <span class="va">chrom_ld</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ##------ Fri Mar 10 15:50:21 2023 ------## ******* 1st: Single_data_input function start! ********</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ** Start to read the single cell data!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ** Start to filter single cell data!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Input single cell data!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 10 cell types are remain, after filter!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> done!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ##------ Fri Mar 10 15:50:22 2023 ------## ******* 2nd: Pathway_pcascore_run function start!! ********</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> * Start to get Pathway SVD socre!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%[1] "Celltype1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |==============                                                        |  20%[1] "Celltype3"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |=====================                                                 |  30%[1] "Celltype5"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |============================                                          |  40%[1] "Celltype4"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |===================================                                   |  50%[1] "Celltype9"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |==========================================                            |  60%[1] "Celltype7"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |=================================================                     |  70%[1] "Celltype10"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |========================================================              |  80%[1] "Celltype8"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |===============================================================       |  90%[1] "Celltype2"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |======================================================================| 100%[1] "Celltype6"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using score as value column: use value.var to override.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> done!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ##------ Fri Mar 10 15:50:38 2023 ------## ******* 3rd: GWAS_summary_input function start! ********</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in scPagwas_main(Pagwas = Pagwas, gwas_data = NULL, Single_data = paste0("Example_splice",     i, ".rds"), output.prefix = i, output.dirs = "splice_scPagwas",     Pathway_list = Genes_by_pathway_kegg, run_split = TRUE, min_clustercells = 1,     assay = "RNA", block_annotation = block_annotation, chrom_ld = chrom_ld):</span> Error: gwas_data should be input!</span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu">SOAR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SOAR/man/Objects.html" class="external-link">Objects</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu">SOAR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SOAR/man/Remove.html" class="external-link">Remove</a></span><span class="op">(</span><span class="fu">SOAR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SOAR/man/Objects.html" class="external-link">Objects</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="va">set.dirs</span><span class="op">)</span> <span class="co">#you must set the workfiles the same as before</span></span></span>
<span class="r-in"><span><span class="va">Pagwas_integrate</span> <span class="op">&lt;-</span> <span class="fu">merge_pagwas</span><span class="op">(</span>Single_data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"scRNAexample.rds"</span>, package <span class="op">=</span> <span class="st">"scPagwas"</span><span class="op">)</span> ,<span class="co"># read the whole single cell data.</span></span></span>
<span class="r-in"><span>                                output.dirs<span class="op">=</span><span class="st">"splice_scPagwas"</span>, <span class="co">#The same with scPagwas_main functionn_topgenes = 1000,</span></span></span>
<span class="r-in"><span>                                assay<span class="op">=</span><span class="st">'RNA'</span>,</span></span>
<span class="r-in"><span>                                random<span class="op">=</span><span class="cn">T</span>,</span></span>
<span class="r-in"><span>                                seed<span class="op">=</span><span class="fl">1234</span>,</span></span>
<span class="r-in"><span>                                random_times<span class="op">=</span><span class="fl">10</span>,</span></span>
<span class="r-in"><span>                                proportion<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ** Start to read the single cell data!</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The total length of the result of scPagwas.gPAS.score for your splited single cell data</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>             is not the same with your Single_data, Please check the code before or the min_clustercells</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>             parameter(set to 1)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Start to run the corSparse function in random!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Randome Times: 1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Randome Times: 2"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Randome Times: 3"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Randome Times: 4"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Randome Times: 5"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Randome Times: 6"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Randome Times: 7"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Randome Times: 8"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Randome Times: 9"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Randome Times: 10"</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Start to run the scGene_rankP function in random!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Randome Times: 1"</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in `[.data.frame`(CellScalepValue, , "pValueHighScale"):</span> undefined columns selected</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Chunyu Deng.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

