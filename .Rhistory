renv::init()
renv::snapshot()
usethis::use_readme_rmd()
devtools::document()
renv::init()
renv::snapshot()
devtools::document()
#' @param filenames the filename of the output plot, default is test_forest.pdf"
#' @param width figure width
#' @param height figure height
#'
#' @return
#' @export
#'
#' @examples
#' library(scPagwas)
#' bootstrap_estimate_Plot(Pagwas,filenames="test_forest.pdf",width = 9,height =7)
bootstrap_estimate_Plot<-function(Pagwas,filenames="test_forest.pdf",width = 9,height =7){
#options(forestplot_new_page = FALSE)
suppressMessages(require(forestplot))
bootstrap_results<-Pagwas$bootstrap_results[-1,c("bp_value","bias_corrected_estimate","CI_lo","CI_hi")]
bootstrap_results<- bootstrap_results[order(bootstrap_results$bias_corrected_estimate,decreasing=T),]
dat <- data.frame(
Index = 1:nrow(bootstrap_results), ## This provides an order to the data
label = rownames(bootstrap_results),
estimate=bootstrap_results$bias_corrected_estimate,
lower=bootstrap_results$CI_lo,
upper=bootstrap_results$CI_hi,
Pvalue = bootstrap_results$bp_value
)
plot1 <- ggplot(dat, aes(y = Index, x = estimate)) +
geom_errorbarh(aes(xmin = lower, xmax = upper),color="#6D8299", height = 0.25) +
geom_point(shape = 18, size = 5,color="#D57E7E") +
geom_vline(xintercept =0, color = "#444444", linetype = "dashed", cex = 1, alpha = 0.5) +
scale_y_continuous(name = "", breaks=1:nrow(dat), labels = dat$label, trans = "reverse") +
xlab("bias_corrected_estimate (95% CI)") +
ylab(" ") +
theme_bw() +
theme(panel.border = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"),
axis.text.y = element_text(size = 12, colour = "black"),
axis.text.x.bottom = element_text(size = 12, colour = "black"),
axis.title.x = element_text(size = 12, colour = "black"))
#plot1
table_base <- ggplot(dat, aes(y=label)) +
ylab(NULL) + xlab("  ") +
theme(plot.title = element_text(hjust = 0.5, size=12),
axis.text.x = element_text(color="white", hjust = -3, size = 25), ## This is used to help with alignment
axis.line = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.background = element_blank(),
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.background = element_blank())
## OR point estimate table
tab1 <- table_base +
labs(title = "space") +
geom_text(aes(y = rev(Index), x = 1, label = sprintf("%.3f", round(Pvalue, digits = 3))), size = 4) + ## decimal places
ggtitle("Pvalue")
lay <-  matrix(c(1,1,1,1,1,1,1,1,1,1,2,3,3), nrow = 1)
plot2<-grid.arrange(plot1, tab1,layout_matrix = lay)
print(plot2)
pdf(file=filenames,width = width, height =height)
print(plot2)
dev.off()
}
devtools::document()
rm(list = c("bootstrap_estimate_Plot")
)
devtools::document()
library(scPagwas)
devtools::document()
library(scPagwas)
?bootstrap_P_Barplot
devtools::document()
renv::snapshot()
devtools::document()
library(scPagwas)
?Bootstrap_P_Barplot
devtools::document()
library(scPagwas)
renv::snapshot()
devtools::document()
library(scPagwas)
devtools::document()
devtools::document()
#' # Pull all genes for each pathway
#' pathway.codes <- sub("path:", "", names(pathways.list))
#' Genes_by_pathway.kegg <- sapply(pathway.codes,function(pwid){
#' pw <- keggGet(pwid)
#' if (is.null(pw[[1]]$GENE)) return(NA)
#' pw2 <- pw[[1]]$GENE[c(FALSE,TRUE)] # may need to modify this to c(FALSE, TRUE) for other organisms
#' pw2 <- unlist(lapply(strsplit(pw2, split = ";", fixed = T), function(x)x[1]))
#'  return(pw2)
#' })
#' }
#'
devtools::document()
devtools::document()
renv::snapshot()
devtools::document()
devtools::document()
devtools::document()
library(scPagwas)
devtools::document()
library(scPagwas)
devtools::document()
library(scPagwas)
library(scPagwas)
devtools::document()
library(scPagwas)
